{% extends "layout.html" %}

{% block body %}
  <form method="POST" class="form-inline" action="{{ url_for('movies_filter') }}">
    <input type="text" class="form-control" name="filter" />
    <input type="submit" class="btn btn-primary mx-sm-3" value="Filter by actor"/>
  </form>
  {% if filter != "" %}
  <table style="margin-top:10px">
    <tr>
      <td style="padding-right:10px">Current filter: {{ filter }}</td>
      <td>
        <form method="GET" action="{{ url_for('movies_index') }}">
          <input type="submit" class="btn btn-primary btn-sm" value="Remove filter"/>
        </form>
      </td>
    </tr>
  </table>
  {% endif %}
  <table class="table">
    <tr>
      <th style="border-top-style: none">Movie</th>
      <th style="border-top-style: none">Year</th>
      <th style="border-top-style: none">Runtime</th>
      <th style="border-top-style: none">Genre</th>
    </tr>
    {% for movie in movies %}
    <tr>
      <td> <a href="{{ url_for('movies_view', movie_id=movie.id) }}">{{ movie.name }}</a></td>
      <td>{{ movie.year }}</td>
      <td>{{ movie.runtime }} min</td>
      <td>{{ movie.genre }}</td>
      {% if current_user.is_authenticated and "ADMIN" in current_user.roles() %}
      <td>
        <form method="GET" action="{{ url_for('movies_cast_form', movie_id=movie.id) }}">
          <input type="submit" class="btn btn-secondary btn-sm" value="Update cast"/>
        </form>
      </td>
      <td>
        <form method="GET" action="{{ url_for('movies_update_form', movie_id=movie.id) }}">
          <input type="submit" class="btn btn-secondary btn-sm" value="Update"/>
        </form>
      </td>
       <td>
        <form method="POST" action="{{ url_for('movies_delete', movie_id=movie.id) }}">
          <input type="submit" class="btn btn-danger btn-sm" value="Delete"/>
        </form>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </table>
  {% if not movies %}
    <p>
      No movies found.
    </p>
  {% endif %}
{% endblock %}